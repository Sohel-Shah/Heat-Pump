<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üî• AEROJAL HEATING AND COOLING SYSTEMS LLP| <\n>aerojal25@gmail.com | +91-7028256853 / 9604303943  <b>Heat Pump Sizing Tool</b></title>
  <link
    href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Exo+2:ital,wght@0,300;0,400;0,600;0,900;1,300&family=Share+Tech+Mono&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --bg: #0a0e1a;
      --surface: #0f1628;
      --surface2: #141d35;
      --surface3: #1a2545;
      --border: #1e2d52;
      --border-glow: #2a4080;
      --primary: #ff6b1a;
      --primary-dark: #cc4a00;
      --primary-glow: rgba(255, 107, 26, 0.2);
      --secondary: #00c8ff;
      --secondary-glow: rgba(0, 200, 255, 0.15);
      --accent: #ffb347;
      --text: #d4dff7;
      --text-dim: #7a8db5;
      --text-bright: #eef2ff;
      --success: #00e5a0;
      --danger: #ff4560;
      --mono: 'Share Tech Mono', monospace;
      --head: 'Rajdhani', sans-serif;
      --body: 'Exo 2', sans-serif;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--body);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Background grid */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(255, 107, 26, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 107, 26, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    /* Ambient glow orbs */
    body::after {
      content: '';
      position: fixed;
      top: -200px;
      right: -200px;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(255, 107, 26, 0.08) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    .glow-orb-left {
      position: fixed;
      bottom: -200px;
      left: -200px;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(0, 200, 255, 0.06) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    /* ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ */
    header {
      position: relative;
      z-index: 10;
      background: linear-gradient(135deg, #0d1220 0%, #111830 100%);
      border-bottom: 2px solid var(--primary);
      padding: 0;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--primary), var(--accent), var(--primary), transparent);
      filter: blur(1px);
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 32px;
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .logo-icon {
      font-size: 48px;
      filter: drop-shadow(0 0 20px rgba(255, 107, 26, 0.7));
      animation: flicker 3s ease-in-out infinite;
    }

    @keyframes flicker {

      0%,
      100% {
        filter: drop-shadow(0 0 20px rgba(255, 107, 26, 0.7));
      }

      50% {
        filter: drop-shadow(0 0 35px rgba(255, 107, 26, 1));
      }
    }

    .header-text h1 {
      font-family: var(--head);
      font-size: 36px;
      font-weight: 700;
      letter-spacing: 4px;
      color: var(--text-bright);
      text-transform: uppercase;
      line-height: 1;
    }

    .header-text h1 span {
      color: var(--primary);
    }

    .header-text p {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--text-dim);
      letter-spacing: 2px;
      margin-top: 6px;
    }

    .header-badge {
      margin-left: auto;
      background: linear-gradient(135deg, var(--primary-dark), var(--primary));
      border-radius: 4px;
      padding: 8px 16px;
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: 1px;
      color: white;
      text-align: center;
      line-height: 1.6;
      box-shadow: 0 0 20px rgba(255, 107, 26, 0.4);
    }

    /* ‚îÄ‚îÄ‚îÄ PROGRESS BAR ‚îÄ‚îÄ‚îÄ */
    .progress-wrap {
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 0 32px;
      display: flex;
      align-items: stretch;
      gap: 0;
      overflow-x: auto;
    }

    .step-tab {
      flex: 1;
      min-width: 120px;
      padding: 14px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: var(--head);
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--text-dim);
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all .3s;
      white-space: nowrap;
      text-transform: uppercase;
    }

    .step-tab .step-num {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: var(--surface3);
      border: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--mono);
      font-size: 11px;
      flex-shrink: 0;
      transition: all .3s;
    }

    .step-tab.active {
      color: var(--primary);
      border-bottom-color: var(--primary);
    }

    .step-tab.active .step-num {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
      box-shadow: 0 0 10px rgba(255, 107, 26, 0.5);
    }

    .step-tab.done {
      color: var(--success);
      border-bottom-color: var(--success);
    }

    .step-tab.done .step-num {
      background: var(--success);
      border-color: var(--success);
      color: #001;
    }

    /* ‚îÄ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ‚îÄ */
    main {
      position: relative;
      z-index: 5;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 32px 80px;
    }

    /* ‚îÄ‚îÄ‚îÄ SECTION PANELS ‚îÄ‚îÄ‚îÄ */
    .form-section {
      display: none;
      animation: fadeIn .4s ease;
    }

    .form-section.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }

    .section-icon {
      font-size: 32px;
      filter: drop-shadow(0 0 10px rgba(255, 107, 26, 0.5));
    }

    .section-header h2 {
      font-family: var(--head);
      font-size: 28px;
      font-weight: 700;
      letter-spacing: 3px;
      color: var(--text-bright);
      text-transform: uppercase;
    }

    .section-header h2 span {
      color: var(--primary);
    }

    .section-sub {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--text-dim);
      letter-spacing: 2px;
      margin-top: 4px;
    }

    /* ‚îÄ‚îÄ‚îÄ CARD ‚îÄ‚îÄ‚îÄ */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 28px;
      margin-bottom: 24px;
      position: relative;
      transition: border-color .3s;
    }

    .card:hover {
      border-color: var(--border-glow);
    }

    .card-title {
      font-family: var(--head);
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 2px;
      color: var(--primary);
      text-transform: uppercase;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card-title::before {
      content: '';
      display: block;
      width: 3px;
      height: 16px;
      background: var(--primary);
      border-radius: 2px;
      box-shadow: 0 0 8px var(--primary);
    }

    /* ‚îÄ‚îÄ‚îÄ FORM ELEMENTS ‚îÄ‚îÄ‚îÄ */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-group.full {
      grid-column: 1 / -1;
    }

    label {
      font-family: var(--head);
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 1.5px;
      color: var(--text-dim);
      text-transform: uppercase;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="number"],
    select,
    textarea {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: var(--text);
      font-family: var(--body);
      font-size: 14px;
      padding: 10px 14px;
      outline: none;
      transition: all .3s;
      width: 100%;
    }

    input:focus,
    select:focus,
    textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(255, 107, 26, 0.15), 0 0 15px rgba(255, 107, 26, 0.1);
      background: var(--surface3);
    }

    select option {
      background: var(--surface2);
    }

    /* ‚îÄ‚îÄ‚îÄ CHECKBOX / RADIO GROUPS ‚îÄ‚îÄ‚îÄ */
    .check-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 4px;
    }

    .check-item {
      position: relative;
      cursor: pointer;
    }

    .check-item input {
      display: none;
    }

    .check-item label {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 13px;
      font-family: var(--body);
      font-weight: 400;
      letter-spacing: 0.5px;
      text-transform: none;
      color: var(--text-dim);
      cursor: pointer;
      transition: all .25s;
      white-space: nowrap;
    }

    .check-item label::before {
      content: '';
      width: 14px;
      height: 14px;
      border: 1px solid var(--border-glow);
      border-radius: 3px;
      flex-shrink: 0;
      transition: all .25s;
    }

    .check-item input:checked+label {
      background: rgba(255, 107, 26, 0.12);
      border-color: var(--primary);
      color: var(--text-bright);
    }

    .check-item input:checked+label::before {
      background: var(--primary);
      border-color: var(--primary);
      box-shadow: 0 0 6px rgba(255, 107, 26, 0.5);
    }

    .radio-item input:checked+label::before {
      border-radius: 50%;
    }

    /* ‚îÄ‚îÄ‚îÄ TABLE INPUT ‚îÄ‚îÄ‚îÄ */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .data-table th {
      background: var(--surface3);
      border: 1px solid var(--border);
      padding: 10px 14px;
      text-align: left;
      font-family: var(--head);
      font-size: 11px;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--primary);
    }

    .data-table td {
      border: 1px solid var(--border);
      padding: 8px 10px;
      background: var(--surface2);
    }

    .data-table td input {
      background: transparent;
      border: none;
      padding: 4px;
      width: 100%;
      font-size: 13px;
    }

    .data-table td input:focus {
      box-shadow: none;
      background: rgba(255, 107, 26, 0.05);
    }

    /* ‚îÄ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ‚îÄ */
    .btn-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 40px;
      gap: 16px;
    }

    .btn {
      font-family: var(--head);
      font-size: 14px;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      padding: 14px 32px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: all .3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-dark), var(--primary));
      color: white;
      box-shadow: 0 4px 20px rgba(255, 107, 26, 0.35);
    }

    .btn-primary:hover {
      box-shadow: 0 6px 30px rgba(255, 107, 26, 0.6);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: var(--surface2);
      color: var(--text-dim);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .btn-success {
      background: linear-gradient(135deg, #007a55, var(--success));
      color: #001;
      font-weight: 900;
      box-shadow: 0 4px 20px rgba(0, 229, 160, 0.3);
    }

    .btn-success:hover {
      box-shadow: 0 6px 30px rgba(0, 229, 160, 0.5);
      transform: translateY(-2px);
    }

    /* ‚îÄ‚îÄ‚îÄ RESULTS SECTION ‚îÄ‚îÄ‚îÄ */
    .results-header {
      text-align: center;
      padding: 40px 0 32px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 40px;
    }

    .results-header h2 {
      font-family: var(--head);
      font-size: 40px;
      font-weight: 700;
      letter-spacing: 5px;
      color: var(--text-bright);
      text-transform: uppercase;
      text-shadow: 0 0 40px rgba(255, 107, 26, 0.4);
    }

    .results-header p {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--text-dim);
      letter-spacing: 2px;
      margin-top: 8px;
    }

    /* ‚îÄ‚îÄ‚îÄ METRIC CARDS ‚îÄ‚îÄ‚îÄ */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 32px;
    }

    .metric-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 24px;
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all .3s;
    }

    .metric-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
    }

    .metric-card:hover {
      border-color: var(--border-glow);
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    }

    .metric-icon {
      font-size: 28px;
      margin-bottom: 10px;
      display: block;
      filter: drop-shadow(0 0 8px rgba(255, 107, 26, 0.5));
    }

    .metric-label {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--text-dim);
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .metric-value {
      font-family: var(--head);
      font-size: 32px;
      font-weight: 700;
      color: var(--primary);
      line-height: 1;
      text-shadow: 0 0 20px rgba(255, 107, 26, 0.5);
    }

    .metric-value.blue {
      color: var(--secondary);
      text-shadow: 0 0 20px rgba(0, 200, 255, 0.5);
    }

    .metric-value.green {
      color: var(--success);
      text-shadow: 0 0 20px rgba(0, 229, 160, 0.5);
    }

    .metric-value.gold {
      color: var(--accent);
      text-shadow: 0 0 20px rgba(255, 179, 71, 0.5);
    }

    .metric-unit {
      font-family: var(--body);
      font-size: 13px;
      color: var(--text-dim);
      margin-top: 4px;
    }

    /* ‚îÄ‚îÄ‚îÄ RESULT DETAIL TABLE ‚îÄ‚îÄ‚îÄ */
    .result-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    .result-table tr {
      border-bottom: 1px solid var(--border);
      transition: background .2s;
    }

    .result-table tr:hover {
      background: rgba(255, 107, 26, 0.04);
    }

    .result-table th {
      background: var(--surface3);
      padding: 12px 20px;
      text-align: left;
      font-family: var(--head);
      font-size: 12px;
      letter-spacing: 2px;
      color: var(--primary);
      text-transform: uppercase;
    }

    .result-table td {
      padding: 14px 20px;
      color: var(--text);
    }

    .result-table td:last-child {
      font-family: var(--mono);
      color: var(--text-bright);
      font-weight: 600;
      text-align: right;
    }

    /* ‚îÄ‚îÄ‚îÄ CHART / BARS ‚îÄ‚îÄ‚îÄ */
    .energy-bars {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 16px;
    }

    .bar-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .bar-label {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--text-dim);
      width: 160px;
      flex-shrink: 0;
      letter-spacing: 1px;
    }

    .bar-track {
      flex: 1;
      height: 20px;
      background: var(--surface3);
      border-radius: 3px;
      overflow: hidden;
      position: relative;
    }

    .bar-fill {
      height: 100%;
      border-radius: 3px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 8px;
      font-family: var(--mono);
      font-size: 10px;
      font-weight: 700;
      color: white;
      transition: width 1.5s cubic-bezier(.16, .7, .28, 1);
      width: 0;
    }

    .bar-fill.orange {
      background: linear-gradient(90deg, var(--primary-dark), var(--primary));
    }

    .bar-fill.blue {
      background: linear-gradient(90deg, #0077aa, var(--secondary));
    }

    .bar-fill.green {
      background: linear-gradient(90deg, #007a55, var(--success));
    }

    /* ‚îÄ‚îÄ‚îÄ RECOMMENDATION BOX ‚îÄ‚îÄ‚îÄ */
    .rec-box {
      background: linear-gradient(135deg, rgba(255, 107, 26, 0.08) 0%, rgba(0, 200, 255, 0.05) 100%);
      border: 1px solid rgba(255, 107, 26, 0.3);
      border-radius: 8px;
      padding: 24px;
      margin-top: 24px;
    }

    .rec-title {
      font-family: var(--head);
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 2px;
      color: var(--accent);
      text-transform: uppercase;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .rec-box ul {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .rec-box li {
      font-size: 14px;
      color: var(--text);
      padding-left: 20px;
      position: relative;
    }

    .rec-box li::before {
      content: '‚ñ∂';
      position: absolute;
      left: 0;
      color: var(--primary);
      font-size: 10px;
    }

    /* ‚îÄ‚îÄ‚îÄ CALCULATION DETAILS ‚îÄ‚îÄ‚îÄ */
    .calc-box {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-left: 3px solid var(--secondary);
      border-radius: 4px;
      padding: 20px;
      font-family: var(--mono);
      font-size: 13px;
      line-height: 2;
      color: var(--text-dim);
      margin-top: 16px;
    }

    .calc-box .eq {
      color: var(--secondary);
      font-size: 14px;
      font-weight: 700;
    }

    .calc-box .result-eq {
      color: var(--success);
      font-size: 15px;
      border-top: 1px solid var(--border);
      margin-top: 8px;
      padding-top: 8px;
    }

    /* ‚îÄ‚îÄ‚îÄ PRINT / EXPORT ‚îÄ‚îÄ‚îÄ */
    .export-row {
      display: flex;
      gap: 12px;
      margin-top: 32px;
      justify-content: center;
    }

    .btn-outline {
      font-family: var(--head);
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      transition: all .3s;
      background: transparent;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-outline-orange {
      border: 1px solid var(--primary);
      color: var(--primary);
    }

    .btn-outline-orange:hover {
      background: rgba(255, 107, 26, 0.1);
    }

    .btn-outline-blue {
      border: 1px solid var(--secondary);
      color: var(--secondary);
    }

    .btn-outline-blue:hover {
      background: rgba(0, 200, 255, 0.1);
    }

    /* ‚îÄ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ‚îÄ */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: var(--surface);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-glow);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }

    /* ‚îÄ‚îÄ‚îÄ TOOLTIP ‚îÄ‚îÄ‚îÄ */
    .info-tag {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      background: var(--border-glow);
      border-radius: 50%;
      font-size: 10px;
      color: var(--secondary);
      cursor: help;
      margin-left: 4px;
      vertical-align: middle;
      font-family: var(--mono);
      position: relative;
    }

    .info-tag:hover::after {
      content: attr(data-tip);
      position: absolute;
      left: 20px;
      top: -4px;
      background: var(--surface3);
      border: 1px solid var(--border-glow);
      padding: 6px 10px;
      border-radius: 4px;
      font-size: 11px;
      color: var(--text);
      white-space: nowrap;
      z-index: 100;
      min-width: 200px;
      white-space: normal;
      width: 220px;
      font-family: var(--body);
      line-height: 1.5;
    }

    /* ‚îÄ‚îÄ‚îÄ STATUS BADGE ‚îÄ‚îÄ‚îÄ */
    .badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 20px;
      font-family: var(--mono);
      font-size: 10px;
      letter-spacing: 1px;
      font-weight: 700;
    }

    .badge-warn {
      background: rgba(255, 179, 71, 0.2);
      color: var(--accent);
      border: 1px solid rgba(255, 179, 71, 0.4);
    }

    .badge-ok {
      background: rgba(0, 229, 160, 0.15);
      color: var(--success);
      border: 1px solid rgba(0, 229, 160, 0.3);
    }

    .badge-info {
      background: rgba(0, 200, 255, 0.15);
      color: var(--secondary);
      border: 1px solid rgba(0, 200, 255, 0.3);
    }

    /* ‚îÄ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ‚îÄ */
    .divider {
      border: none;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--border), transparent);
      margin: 28px 0;
    }

    /* ‚îÄ‚îÄ‚îÄ WATERMARK ‚îÄ‚îÄ‚îÄ */
    .watermark {
      text-align: center;
      font-family: var(--mono);
      font-size: 11px;
      color: var(white);
      letter-spacing: 2px;
      margin-top: 40px;
      opacity: 1;
    }

    /* ‚îÄ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ‚îÄ */
    @media (max-width: 768px) {
      .header-inner {
        padding: 16px;
        flex-wrap: wrap;
      }

      .header-badge {
        display: none;
      }

      main {
        padding: 24px 16px 60px;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .metrics-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media print {

      body::before,
      body::after,
      .glow-orb-left {
        display: none;
      }

      .progress-wrap,
      .btn-row,
      .export-row,
      .settings-bar {
        display: none;
      }

      body {
        background: white;
        color: black;
      }

      .card,
      .metric-card,
      .rec-box,
      .calc-box {
        border-color: #ddd;
        background: white;
      }

      .metric-value,
      .result-table td:last-child {
        color: #333;
        text-shadow: none;
      }

      * {
        box-shadow: none !important;
      }
    }

    /* ‚îÄ‚îÄ‚îÄ GOOGLE SHEET SETTINGS BAR ‚îÄ‚îÄ‚îÄ */
    .settings-bar {
      background: var(--surface2);
      border-bottom: 1px solid var(--border);
      padding: 10px 32px;
      display: flex;
      align-items: center;
      gap: 12px;
      position: relative;
      z-index: 10;
    }

    .settings-bar label {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--text-dim);
      letter-spacing: 1px;
      white-space: nowrap;
    }

    .settings-bar input {
      flex: 1;
      max-width: 520px;
      background: var(--surface3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: var(--text);
      font-family: var(--mono);
      font-size: 12px;
      padding: 7px 12px;
      outline: none;
      transition: all .3s;
    }

    .settings-bar input:focus {
      border-color: var(--secondary);
      box-shadow: 0 0 0 2px rgba(0, 200, 255, 0.15);
    }

    .settings-bar .settings-status {
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: 1px;
      padding: 4px 10px;
      border-radius: 20px;
    }

    .settings-status.connected {
      background: rgba(0, 229, 160, 0.15);
      color: var(--success);
      border: 1px solid rgba(0, 229, 160, 0.3);
    }

    .settings-status.disconnected {
      background: rgba(255, 179, 71, 0.15);
      color: var(--accent);
      border: 1px solid rgba(255, 179, 71, 0.3);
    }

    /* ‚îÄ‚îÄ‚îÄ TOAST NOTIFICATIONS ‚îÄ‚îÄ‚îÄ */
    .toast-container {
      position: fixed;
      top: 24px;
      right: 24px;
      z-index: 10000;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .toast {
      min-width: 300px;
      max-width: 420px;
      padding: 16px 20px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-family: var(--body);
      font-size: 14px;
      color: var(--text-bright);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      animation: toastIn 0.4s cubic-bezier(.16, .7, .28, 1);
      transition: all 0.3s;
    }

    .toast.removing {
      animation: toastOut 0.3s ease forwards;
    }

    .toast-loading {
      background: linear-gradient(135deg, #1a2545, #1e2d52);
      border: 1px solid var(--secondary);
    }

    .toast-success {
      background: linear-gradient(135deg, #0a2a1f, #0f3d2e);
      border: 1px solid var(--success);
    }

    .toast-error {
      background: linear-gradient(135deg, #2a0f15, #3d1520);
      border: 1px solid var(--danger);
    }

    .toast-icon {
      font-size: 22px;
      flex-shrink: 0;
    }

    .toast-spinner {
      width: 22px;
      height: 22px;
      border: 3px solid rgba(0, 200, 255, 0.2);
      border-top-color: var(--secondary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      flex-shrink: 0;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @keyframes toastIn {
      from {
        opacity: 0;
        transform: translateX(80px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes toastOut {
      from {
        opacity: 1;
        transform: translateX(0);
      }

      to {
        opacity: 0;
        transform: translateX(80px);
      }
    }

    /* ‚îÄ‚îÄ‚îÄ SAVE BUTTON (Google Sheet) ‚îÄ‚îÄ‚îÄ */
    .btn-outline-green {
      border: 1px solid var(--success);
      color: var(--success);
    }

    .btn-outline-green:hover {
      background: rgba(0, 229, 160, 0.1);
    }

    .btn-outline-green:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
  </style>
</head>

<body>
  <div class="glow-orb-left"></div>

  <!-- HEADER -->
  <header>
    <div class="header-inner">
      <div class="logo-icon">üî•</div>
      <div class="header-text">
        <h1>  AERO<span>JAL</span></h1>
        <h3>HEATING AND COOLING SYSTEMS LLP</h3>
        <p>HEAT PUMP HOT WATER SYSTEM ‚Äî SIZING & REQUIREMENT TOOL</p>
      </div>
      <div class="header-badge">
        Contact: +91-7028256853 / 9604303943<br>Email: aerojal25@gmail.com<br>Web: www.yourcompany.com
      </div>
    </div>
  </header>


  <!-- PROGRESS TABS -->
  <div class="progress-wrap" id="progressBar">
    <div class="step-tab active" data-step="1" onclick="goToStep(1)">
      <div class="step-num">1</div> Customer & Site
    </div>
    <div class="step-tab" data-step="2" onclick="goToStep(2)">
      <div class="step-num">2</div> Application
    </div>
    <div class="step-tab" data-step="3" onclick="goToStep(3)">
      <div class="step-num">3</div> Demand Details
    </div>
    <div class="step-tab" data-step="4" onclick="goToStep(4)">
      <div class="step-num">4</div> Existing System
    </div>
    <div class="step-tab" data-step="5" onclick="goToStep(5)">
      <div class="step-num">5</div> Installation
    </div>
    <div class="step-tab" data-step="6" onclick="goToStep(6)">
      <div class="step-num">6</div> Expectations
    </div>
    <div class="step-tab" data-step="7" onclick="goToStep(7)">
      <div class="step-num">7</div> Results ‚ö°
    </div>
  </div>

  <main>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 1 ‚Äî CUSTOMER & SITE DETAILS -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section active" id="step1">
      <div class="section-header">
        <div class="section-icon">üè¢</div>
        <div>
          <h2>Section <span>A</span> ‚Äî Customer & Site Details</h2>
          <div class="section-sub">BASIC INFORMATION FOR PROJECT IDENTIFICATION</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Contact Information</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Customer Name / Organisation *</label>
            <input type="text" id="customerName" placeholder="e.g. Grand Plaza Hotel">
          </div>
          <div class="form-group">
            <label>Contact Person</label>
            <input type="text" id="contactPerson" placeholder="Full name">
          </div>
          <div class="form-group">
            <label>Mobile Number</label>
            <input type="tel" id="mobile" placeholder="+91 XXXXX XXXXX">
          </div>
          <div class="form-group">
            <label>Email ID</label>
            <input type="email" id="email" placeholder="email@company.com">
          </div>
          <div class="form-group full">
            <label>Site Address</label>
            <input type="text" id="address" placeholder="Full site address">
          </div>
          <div class="form-group">
            <label>City</label>
            <input type="text" id="city" placeholder="City name">
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" id="state" placeholder="State name">
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Type of Facility</div>
        <div class="check-group">
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fHotel" value="Hotel">
            <label for="fHotel">üè® Hotel</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fHospital" value="Hospital">
            <label for="fHospital">üè• Hospital</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fHostel" value="Hostel">
            <label for="fHostel">üè† Hostel</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fResidential" value="Residential Society">
            <label for="fResidential">üèòÔ∏è Residential Society</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fIndustrial" value="Industrial Process">
            <label for="fIndustrial">üè≠ Industrial Process</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fDairy" value="Dairy / Food Processing">
            <label for="fDairy">ü•õ Dairy / Food Processing</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="facilityType" id="fOther" value="Others">
            <label for="fOther">üîß Others</label>
          </div>
        </div>
        <div class="form-group" style="margin-top:16px; max-width:320px;" id="facilityOtherWrap" style="display:none">
          <input type="text" id="facilityOther" placeholder="Specify facility type">
        </div>
      </div>

      <div class="btn-row">
        <span></span>
        <button class="btn btn-primary" onclick="nextStep(1)">Next: Application Details ‚Üí</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 2 ‚Äî APPLICATION DETAILS -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section" id="step2">
      <div class="section-header">
        <div class="section-icon">üíß</div>
        <div>
          <h2>Section <span>B</span> ‚Äî Application Details</h2>
          <div class="section-sub">PURPOSE & TEMPERATURE REQUIREMENTS</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Purpose of Hot Water</div>
        <div class="check-group">
          <div class="check-item"><input type="checkbox" id="pBathing"><label for="pBathing">üöø Bathing</label></div>
          <div class="check-item"><input type="checkbox" id="pKitchen"><label for="pKitchen">üç≥ Kitchen /
              Washing</label></div>
          <div class="check-item"><input type="checkbox" id="pLaundry"><label for="pLaundry">üëï Laundry</label></div>
          <div class="check-item"><input type="checkbox" id="pProcess"><label for="pProcess">‚öôÔ∏è Process Heating</label>
          </div>
          <div class="check-item"><input type="checkbox" id="pCleaning"><label for="pCleaning">üßπ Cleaning / CIP</label>
          </div>
          <div class="check-item"><input type="checkbox" id="pOther"><label for="pOther">üì¶ Others</label></div>
        </div>
        <div class="form-group" style="margin-top:16px; max-width:320px;">
          <input type="text" id="purposeOther" placeholder="Specify other purpose (if any)">
        </div>
      </div>

      <div class="card">
        <div class="card-title">Required Hot Water Temperature
          <span class="info-tag"
            data-tip="Higher temperatures require more energy. 60¬∞C is recommended for legionella prevention in large systems.">i</span>
        </div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="hotTemp" id="t45" value="45"><label
              for="t45">45¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="hotTemp" id="t50" value="50"><label
              for="t50">50¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="hotTemp" id="t55" value="55"><label
              for="t55">55¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="hotTemp" id="t60" value="60" checked><label
              for="t60">60¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="hotTemp" id="tCustom" value="custom"><label
              for="tCustom">Custom</label></div>
        </div>
        <div class="form-group" style="margin-top:12px; max-width:200px;">
          <input type="number" id="hotTempCustom" placeholder="Enter ¬∞C" min="40" max="90" style="display:none">
        </div>
      </div>

      <div class="card">
        <div class="card-title">Cold Water Inlet Temperature
          <span class="info-tag"
            data-tip="Affects energy calculation. For Indian plains, 20‚Äì25¬∞C is typical. In hills/winter, use 15‚Äì20¬∞C.">i</span>
        </div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="coldTemp" id="c1" value="17.5"><label
              for="c1">15‚Äì20¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="coldTemp" id="c2" value="22.5" checked><label
              for="c2">20‚Äì25¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="coldTemp" id="c3" value="27.5"><label
              for="c3">25‚Äì30¬∞C</label></div>
          <div class="check-item radio-item"><input type="radio" name="coldTemp" id="cUnknown" value="22.5"><label
              for="cUnknown">Not known</label></div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" onclick="prevStep(2)">‚Üê Back</button>
        <button class="btn btn-primary" onclick="nextStep(2)">Next: Demand Details ‚Üí</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 3 ‚Äî HOT WATER DEMAND DETAILS -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section" id="step3">
      <div class="section-header">
        <div class="section-icon">üìä</div>
        <div>
          <h2>Section <span>C</span> ‚Äî Hot Water Demand Details</h2>
          <div class="section-sub">DAILY CONSUMPTION & PEAK USAGE PATTERNS</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Total Hot Water Requirement per Day</div>
        <div class="check-group" style="margin-bottom:16px;">
          <div class="check-item radio-item">
            <input type="radio" name="demandKnown" id="dKnown" value="known" checked onchange="toggleDemandMode()">
            <label for="dKnown">‚úÖ Known ‚Äî I'll enter the value</label>
          </div>
          <div class="check-item radio-item">
            <input type="radio" name="demandKnown" id="dUnknown" value="unknown" onchange="toggleDemandMode()">
            <label for="dUnknown">‚ùì Not known ‚Äî Help me calculate</label>
          </div>
        </div>

        <div id="knownDemandWrap">
          <div class="form-group" style="max-width:300px;">
            <label>Daily Requirement (Litres/day)</label>
            <input type="number" id="dailyLitres" placeholder="e.g. 5000" min="100" max="500000">
          </div>
        </div>

        <div id="unknownDemandWrap" style="display:none;">
          <p style="font-size:13px; color:var(--text-dim); margin-bottom:16px;">Enter usage details below ‚Äî we'll
            calculate the total demand:</p>
          <div style="overflow-x:auto;">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Area / Use</th>
                  <th>No. of Users / Units</th>
                  <th>Litres per User/Day</th>
                  <th>Calculated (L/day)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Bathrooms / Rooms</td>
                  <td><input type="number" id="bathUsers" placeholder="0" min="0" oninput="calcDemand()"></td>
                  <td><input type="number" id="bathLpd" placeholder="30" min="0" oninput="calcDemand()"></td>
                  <td id="bathTotal" style="font-family:var(--mono); color:var(--accent);">0 L</td>
                </tr>
                <tr>
                  <td>Kitchen / Canteen</td>
                  <td><input type="number" id="kitchenUsers" placeholder="0" min="0" oninput="calcDemand()"></td>
                  <td><input type="number" id="kitchenLpd" placeholder="10" min="0" oninput="calcDemand()"></td>
                  <td id="kitchenTotal" style="font-family:var(--mono); color:var(--accent);">0 L</td>
                </tr>
                <tr>
                  <td>Laundry (kg/day)</td>
                  <td><input type="number" id="laundryKg" placeholder="0" min="0" oninput="calcDemand()"></td>
                  <td><input type="number" id="laundryLpd" placeholder="10" min="0" oninput="calcDemand()"></td>
                  <td id="laundryTotal" style="font-family:var(--mono); color:var(--accent);">0 L</td>
                </tr>
                <tr>
                  <td>Process / Others</td>
                  <td><input type="number" id="processUsers" placeholder="0" min="0" oninput="calcDemand()"></td>
                  <td><input type="number" id="processLpd" placeholder="50" min="0" oninput="calcDemand()"></td>
                  <td id="processTotal" style="font-family:var(--mono); color:var(--accent);">0 L</td>
                </tr>
                <tr style="background:rgba(255,107,26,0.08);">
                  <td colspan="3"
                    style="font-family:var(--head); font-weight:700; letter-spacing:1px; color:var(--primary);">TOTAL
                    ESTIMATED DEMAND</td>
                  <td id="totalCalcDemand"
                    style="font-family:var(--mono); color:var(--primary); font-size:16px; font-weight:700;">0 L/day</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Peak Usage Pattern</div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="peakPattern" id="ppMorning" value="morning"
              checked><label for="ppMorning">üåÖ Morning Peak</label></div>
          <div class="check-item radio-item"><input type="radio" name="peakPattern" id="ppEvening"
              value="evening"><label for="ppEvening">üåÜ Evening Peak</label></div>
          <div class="check-item radio-item"><input type="radio" name="peakPattern" id="ppCont"
              value="continuous"><label for="ppCont">‚è±Ô∏è Continuous (24√ó7)</label></div>
          <div class="check-item radio-item"><input type="radio" name="peakPattern" id="ppBatch" value="batch"><label
              for="ppBatch">üì¶ Batch-wise</label></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Operating Hours for Heat Pump
          <span class="info-tag"
            data-tip="Longer operation hours = smaller, cheaper heat pump. Shorter hours = bigger heat pump for same output.">i</span>
        </div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="opHours" id="oh1" value="6"><label for="oh1">6
              Hours</label></div>
          <div class="check-item radio-item"><input type="radio" name="opHours" id="oh2" value="8" checked><label
              for="oh2">8 Hours</label></div>
          <div class="check-item radio-item"><input type="radio" name="opHours" id="oh3" value="10"><label for="oh3">10
              Hours</label></div>
          <div class="check-item radio-item"><input type="radio" name="opHours" id="oh4" value="12"><label for="oh4">12
              Hours</label></div>
          <div class="check-item radio-item"><input type="radio" name="opHours" id="oh5" value="16"><label for="oh5">16
              Hours</label></div>
          <div class="check-item radio-item"><input type="radio" name="opHours" id="oh6" value="20"><label for="oh6">20
              Hours</label></div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" onclick="prevStep(3)">‚Üê Back</button>
        <button class="btn btn-primary" onclick="nextStep(3)">Next: Existing System ‚Üí</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 4 ‚Äî EXISTING SYSTEM -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section" id="step4">
      <div class="section-header">
        <div class="section-icon">üîß</div>
        <div>
          <h2>Section <span>D</span> ‚Äî Existing System</h2>
          <div class="section-sub">CURRENT SETUP & PAIN POINTS</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Current Hot Water System</div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="existSys" id="esGeyser"
              value="Electric Geyser"><label for="esGeyser">‚ö° Electric Geyser</label></div>
          <div class="check-item radio-item"><input type="radio" name="existSys" id="esDiesel"
              value="Diesel Boiler"><label for="esDiesel">üõ¢Ô∏è Diesel Boiler</label></div>
          <div class="check-item radio-item"><input type="radio" name="existSys" id="esLPG" value="LPG Boiler"><label
              for="esLPG">üî• LPG Boiler</label></div>
          <div class="check-item radio-item"><input type="radio" name="existSys" id="esSolar"
              value="Solar Water Heater"><label for="esSolar">‚òÄÔ∏è Solar Water Heater</label></div>
          <div class="check-item radio-item"><input type="radio" name="existSys" id="esNone" value="None" checked><label
              for="esNone">üö´ None (New Installation)</label></div>
        </div>
        <div class="form-group" style="margin-top:16px; max-width:300px;">
          <label>Existing Capacity (if applicable)</label>
          <input type="text" id="existCapacity" placeholder="e.g. 500L tank, 25kW boiler">
        </div>
      </div>

      <div class="card">
        <div class="card-title">Problems Faced (select all that apply)</div>
        <div class="check-group">
          <div class="check-item"><input type="checkbox" id="probElec"><label for="probElec">üí∏ High Electricity
              Cost</label></div>
          <div class="check-item"><input type="checkbox" id="probFuel"><label for="probFuel">‚õΩ High Fuel Cost</label>
          </div>
          <div class="check-item"><input type="checkbox" id="probInsuff"><label for="probInsuff">üíß Insufficient Hot
              Water</label></div>
          <div class="check-item"><input type="checkbox" id="probMaint"><label for="probMaint">üî© Maintenance
              Issues</label></div>
          <div class="check-item"><input type="checkbox" id="probSafety"><label for="probSafety">‚ö†Ô∏è Safety
              Concerns</label></div>
          <div class="check-item"><input type="checkbox" id="probEnv"><label for="probEnv">üåø Environmental /
              Pollution</label></div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" onclick="prevStep(4)">‚Üê Back</button>
        <button class="btn btn-primary" onclick="nextStep(4)">Next: Installation ‚Üí</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 5 ‚Äî INSTALLATION & UTILITY DETAILS -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section" id="step5">
      <div class="section-header">
        <div class="section-icon">üèóÔ∏è</div>
        <div>
          <h2>Section <span>E</span> ‚Äî Installation & Utility Details</h2>
          <div class="section-sub">SITE CONDITIONS & CONSTRAINTS</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Available Installation Space</div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="installSpace" id="isTerrace"
              value="Terrace"><label for="isTerrace">üè† Terrace</label></div>
          <div class="check-item radio-item"><input type="radio" name="installSpace" id="isGround" value="Ground Level"
              checked><label for="isGround">üåø Ground Level</label></div>
          <div class="check-item radio-item"><input type="radio" name="installSpace" id="isBasement"
              value="Basement"><label for="isBasement">‚¨áÔ∏è Basement</label></div>
          <div class="check-item radio-item"><input type="radio" name="installSpace" id="isUtility"
              value="Utility Room"><label for="isUtility">üö™ Utility Room</label></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Electrical Power Available</div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="elecPhase" id="ep1" value="Single Phase"><label
              for="ep1">Single Phase (230V)</label></div>
          <div class="check-item radio-item"><input type="radio" name="elecPhase" id="ep3" value="Three Phase"
              checked><label for="ep3">Three Phase (415V)</label></div>
        </div>
        <div class="form-group" style="margin-top:12px; max-width:200px;">
          <label>Voltage (if known)</label>
          <input type="text" id="voltage" placeholder="e.g. 415V">
        </div>
      </div>

      <div class="card">
        <div class="card-title">Water Quality
          <span class="info-tag"
            data-tip="Hard water / high TDS may require a heat exchanger instead of direct heating to protect the heat pump.">i</span>
        </div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="waterQuality" id="wqNormal" value="Normal"
              checked><label for="wqNormal">‚úÖ Normal (TDS &lt; 200)</label></div>
          <div class="check-item radio-item"><input type="radio" name="waterQuality" id="wqHard"
              value="Hard Water"><label for="wqHard">‚ö†Ô∏è Hard Water</label></div>
          <div class="check-item radio-item"><input type="radio" name="waterQuality" id="wqBore" value="Borewell"><label
              for="wqBore">üï≥Ô∏è Borewell</label></div>
          <div class="check-item radio-item"><input type="radio" name="waterQuality" id="wqHighTDS"
              value="High TDS (>500 ppm)"><label for="wqHighTDS">üî¥ TDS &gt; 500 ppm</label></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Ambient Temperature Range
          <span class="info-tag"
            data-tip="Heat pump COP decreases at lower ambient temperatures. Very low ambient may require special low-temperature models.">i</span>
        </div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="ambientTemp" id="at1" value="<15¬∞C"><label
              for="at1">&lt; 15¬∞C (Hill / Winter)</label></div>
          <div class="check-item radio-item"><input type="radio" name="ambientTemp" id="at2" value="15-25¬∞C"
              checked><label for="at2">15‚Äì25¬∞C (Moderate)</label></div>
          <div class="check-item radio-item"><input type="radio" name="ambientTemp" id="at3" value="25-35¬∞C"><label
              for="at3">25‚Äì35¬∞C (Hot / Tropical)</label></div>
          <div class="check-item radio-item"><input type="radio" name="ambientTemp" id="at4" value=">35¬∞C"><label
              for="at4">&gt; 35¬∞C (Very Hot)</label></div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" onclick="prevStep(5)">‚Üê Back</button>
        <button class="btn btn-primary" onclick="nextStep(5)">Next: Client Expectations ‚Üí</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 6 ‚Äî CLIENT EXPECTATIONS -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section" id="step6">
      <div class="section-header">
        <div class="section-icon">üéØ</div>
        <div>
          <h2>Section <span>F</span> ‚Äî Client Expectations</h2>
          <div class="section-sub">PRIORITIES & BUDGET</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Top Priority (Select your #1 priority)</div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="priority" id="prEnergy" value="Energy saving"
              checked><label for="prEnergy">‚ö° Maximum Energy Saving</label></div>
          <div class="check-item radio-item"><input type="radio" name="priority" id="prCapex"
              value="Low capital cost"><label for="prCapex">üí∞ Low Capital Cost</label></div>
          <div class="check-item radio-item"><input type="radio" name="priority" id="prMaint"
              value="Low maintenance"><label for="prMaint">üîß Low Maintenance</label></div>
          <div class="check-item radio-item"><input type="radio" name="priority" id="prFast" value="Fast heating"><label
              for="prFast">‚ö° Fast Heating Response</label></div>
          <div class="check-item radio-item"><input type="radio" name="priority" id="prRedundancy"
              value="Redundancy"><label for="prRedundancy">üîÑ Redundancy / Backup</label></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Budget Range</div>
        <div class="check-group">
          <div class="check-item radio-item"><input type="radio" name="budget" id="b1" value="< ‚Çπ5 lakh"><label
              for="b1">&lt; ‚Çπ5 Lakh</label></div>
          <div class="check-item radio-item"><input type="radio" name="budget" id="b2" value="‚Çπ5‚Äì10 lakh"><label
              for="b2">‚Çπ5‚Äì10 Lakh</label></div>
          <div class="check-item radio-item"><input type="radio" name="budget" id="b3" value="‚Çπ10‚Äì20 lakh"><label
              for="b3">‚Çπ10‚Äì20 Lakh</label></div>
          <div class="check-item radio-item"><input type="radio" name="budget" id="b4" value="> ‚Çπ20 lakh"><label
              for="b4">&gt; ‚Çπ20 Lakh</label></div>
          <div class="check-item radio-item"><input type="radio" name="budget" id="b5" value="Open"><label for="b5">Open
              / ROI-based</label></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Additional Notes / Special Requirements</div>
        <div class="form-group">
          <textarea id="notes" rows="4"
            placeholder="Any special requirements, constraints, or notes for the design team..."></textarea>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" onclick="prevStep(6)">‚Üê Back</button>
        <button class="btn btn-success" onclick="calculateAndShow()">‚ö° CALCULATE & SHOW RESULTS ‚Üí</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- STEP 7 ‚Äî RESULTS -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="form-section" id="step7">

      <div class="results-header">
        <h2>‚ö° Design Recommendation</h2>
        <p id="resultsSubtitle">HEAT PUMP HOT WATER SYSTEM ‚Äî SIZING REPORT</p>
      </div>

      <!-- Customer Summary Bar -->
      <div class="card" style="border-color: rgba(0,200,255,0.3); background: rgba(0,200,255,0.04);">
        <div class="card-title" style="color: var(--secondary);">Project Summary</div>
        <div class="form-grid" id="summaryGrid"
          style="font-size:13px; line-height:2; color:var(--text-dim); font-family:var(--mono);">
        </div>
      </div>

      <!-- KEY METRICS -->
      <div class="metrics-grid" id="metricsGrid"></div>

      <!-- DETAILED RECOMMENDATION TABLE -->
      <div class="card">
        <div class="card-title">System Specification</div>
        <div style="overflow-x:auto;">
          <table class="result-table" id="specTable"></table>
        </div>
      </div>

      <!-- CALCULATION STEPS -->
      <div class="card">
        <div class="card-title">Calculation Methodology</div>
        <div class="calc-box" id="calcBox"></div>
      </div>

      <!-- ENERGY COMPARISON CHART -->
      <div class="card">
        <div class="card-title">Energy Cost Comparison (Annual Estimate)</div>
        <div class="energy-bars" id="energyBars"></div>
      </div>

      <!-- RECOMMENDATIONS -->
      <div class="rec-box" id="recBox"></div>

      <!-- WARNINGS -->
      <div id="warningsBox"></div>

      <!-- EXPORT BUTTONS -->
      <div class="export-row">
        <button class="btn-outline btn-outline-green" id="btnSaveSheet" onclick="saveToGoogleSheet()">üíæ Save to Google
          Sheet</button>
        <button class="btn-outline btn-outline-orange" onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>
        <button class="btn-outline btn-outline-blue" onclick="exportCSV()">üì• Export Data (CSV)</button>
        <button class="btn-outline btn-outline-orange" onclick="startOver()">üîÑ New Assessment</button>
      </div>

      <div class="watermark">
        AEROJAL HEATING AND COOLING SYSTEMS LLP<br>
S. No. 44/1 Ganapati Matha, Near Akash Apartment, Warje Malwadi, Pune-411052 <br>
GST No.: 27ACMFA586407 | Website: www.yourcompany.com <br>
Contact: +91-7028256853 / 9604303943 | Email: aerojal25@gmail.com ‚Äî GENERATED: <span id="genDate"></span>
      </div>
    </div>

  </main>

  <!-- Toast notification container -->
  <div class="toast-container" id="toastContainer"></div>

  <script>
    // ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let currentStep = 1;
    const totalSteps = 7;

    // ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function goToStep(step) {
      document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
      document.getElementById('step' + step).classList.add('active');

      document.querySelectorAll('.step-tab').forEach((t, i) => {
        t.classList.remove('active', 'done');
        if (i + 1 === step) t.classList.add('active');
        else if (i + 1 < step) t.classList.add('done');
      });
      currentStep = step;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function nextStep(from) { goToStep(from + 1); }
    function prevStep(from) { goToStep(from - 1); }

    // ‚îÄ‚îÄ‚îÄ DEMAND MODE TOGGLE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function toggleDemandMode() {
      const known = document.querySelector('input[name="demandKnown"]:checked').value === 'known';
      document.getElementById('knownDemandWrap').style.display = known ? '' : 'none';
      document.getElementById('unknownDemandWrap').style.display = known ? 'none' : '';
    }

    function calcDemand() {
      const bath = (parseFloat(document.getElementById('bathUsers').value) || 0) * (parseFloat(document.getElementById('bathLpd').value) || 30);
      const kitchen = (parseFloat(document.getElementById('kitchenUsers').value) || 0) * (parseFloat(document.getElementById('kitchenLpd').value) || 10);
      const laundry = (parseFloat(document.getElementById('laundryKg').value) || 0) * (parseFloat(document.getElementById('laundryLpd').value) || 10);
      const process = (parseFloat(document.getElementById('processUsers').value) || 0) * (parseFloat(document.getElementById('processLpd').value) || 50);
      document.getElementById('bathTotal').textContent = bath.toLocaleString() + ' L';
      document.getElementById('kitchenTotal').textContent = kitchen.toLocaleString() + ' L';
      document.getElementById('laundryTotal').textContent = laundry.toLocaleString() + ' L';
      document.getElementById('processTotal').textContent = process.toLocaleString() + ' L';
      const total = bath + kitchen + laundry + process;
      document.getElementById('totalCalcDemand').textContent = total.toLocaleString() + ' L/day';
    }

    // Hot temp custom input toggle
    document.querySelectorAll('input[name="hotTemp"]').forEach(r => {
      r.addEventListener('change', () => {
        document.getElementById('hotTempCustom').style.display =
          r.value === 'custom' ? '' : 'none';
      });
    });

    // Facility other toggle
    document.querySelectorAll('input[name="facilityType"]').forEach(r => {
      r.addEventListener('change', () => {
        document.getElementById('facilityOtherWrap').style.display =
          r.value === 'Others' ? '' : 'none';
      });
    });

    // ‚îÄ‚îÄ‚îÄ MAIN CALCULATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function calculateAndShow() {
      // ‚îÄ‚îÄ 1. Gather inputs ‚îÄ‚îÄ
      const facilityType = document.querySelector('input[name="facilityType"]:checked')?.value || 'Unknown';

      // Hot temp
      let hotTempVal = parseFloat(document.querySelector('input[name="hotTemp"]:checked')?.value) || 60;
      if (document.querySelector('input[name="hotTemp"]:checked')?.value === 'custom') {
        hotTempVal = parseFloat(document.getElementById('hotTempCustom').value) || 60;
      }

      // Cold temp
      const coldTempVal = parseFloat(document.querySelector('input[name="coldTemp"]:checked')?.value) || 22.5;

      // Daily demand
      let dailyLitres = 0;
      const demandKnown = document.querySelector('input[name="demandKnown"]:checked')?.value === 'known';
      if (demandKnown) {
        dailyLitres = parseFloat(document.getElementById('dailyLitres').value) || 1000;
      } else {
        const bath = (parseFloat(document.getElementById('bathUsers').value) || 0) * (parseFloat(document.getElementById('bathLpd').value) || 30);
        const kitchen = (parseFloat(document.getElementById('kitchenUsers').value) || 0) * (parseFloat(document.getElementById('kitchenLpd').value) || 10);
        const laundry = (parseFloat(document.getElementById('laundryKg').value) || 0) * (parseFloat(document.getElementById('laundryLpd').value) || 10);
        const process = (parseFloat(document.getElementById('processUsers').value) || 0) * (parseFloat(document.getElementById('processLpd').value) || 50);
        dailyLitres = bath + kitchen + laundry + process;
        if (dailyLitres === 0) dailyLitres = 1000;
      }

      // Operating hours
      const opHours = parseFloat(document.querySelector('input[name="opHours"]:checked')?.value) || 8;

      // Ambient temp
      const ambientStr = document.querySelector('input[name="ambientTemp"]:checked')?.value || '25-35¬∞C';

      // Water quality
      const waterQuality = document.querySelector('input[name="waterQuality"]:checked')?.value || 'Normal';

      // Priority
      const priority = document.querySelector('input[name="priority"]:checked')?.value || 'Energy saving';

      // ‚îÄ‚îÄ 2. Heat load calculation ‚îÄ‚îÄ
      const Cp = 4.186; // kJ/kg¬∞C
      const deltaT = hotTempVal - coldTempVal;
      const heatKJ = dailyLitres * Cp * deltaT;
      const heatKWh = heatKJ / 3600;

      // ‚îÄ‚îÄ 3. COP based on ambient and temp ‚îÄ‚îÄ
      let COP = 4.0;
      if (ambientStr.includes('<15')) COP = 3.0;
      else if (ambientStr.includes('15-25')) COP = 3.8;
      else if (ambientStr.includes('25-35')) COP = 4.2;
      else if (ambientStr.includes('>35')) COP = 4.5;
      // Higher temp delivery reduces COP slightly
      if (hotTempVal > 60) COP -= 0.3;
      if (hotTempVal >= 70) COP -= 0.5;
      COP = Math.max(2.5, Math.round(COP * 10) / 10);

      // ‚îÄ‚îÄ 4. HP capacity (with 20% safety margin) ‚îÄ‚îÄ
      const hpCapacityRaw = heatKWh / opHours;
      const hpCapacity = Math.ceil(hpCapacityRaw * 1.20);  // +20% margin
      const hpTR = (hpCapacity / 3.517).toFixed(1);   // 1 TR = 3.517 kW

      // ‚îÄ‚îÄ 5. Number of units ‚îÄ‚îÄ
      const unitSize = priority === 'Redundancy' ? Math.min(hpCapacity / 2, 15) :
        hpCapacity <= 15 ? hpCapacity : 15;
      const numUnits = Math.ceil(hpCapacity / unitSize);
      const unitKW = Math.ceil(hpCapacity / numUnits);

      // ‚îÄ‚îÄ 6. Storage tank ‚îÄ‚îÄ
      let storagePct = 0.60;
      if (facilityType === 'Hotel' || facilityType === 'Hostel' || facilityType === 'Residential Society') storagePct = 0.65;
      else if (facilityType === 'Hospital') storagePct = 0.80;
      else if (facilityType === 'Industrial Process' || facilityType === 'Dairy / Food Processing') storagePct = 0.50;
      if (priority === 'Low capital cost') storagePct = Math.min(storagePct, 0.50);
      if (priority === 'Redundancy') storagePct = Math.min(storagePct + 0.15, 1.0);

      const storageLitres = Math.ceil(dailyLitres * storagePct / 100) * 100;

      // ‚îÄ‚îÄ 7. Electrical input ‚îÄ‚îÄ
      const elecInputKWh = heatKWh / COP;
      const elecCostHP = elecInputKWh * 8;   // ‚Çπ8/kWh avg India

      // ‚îÄ‚îÄ 8. Savings vs electric geyser ‚îÄ‚îÄ
      const elecGeyserKWh = heatKWh * 1.05;   // ~5% loss, COP‚âà1
      const elecCostGeyser = elecGeyserKWh * 8;
      const annualSavings = (elecCostGeyser - elecCostHP) * 365;
      const savingPct = ((elecCostGeyser - elecCostHP) / elecCostGeyser * 100).toFixed(0);

      // ‚îÄ‚îÄ 9. Payback (rough) ‚îÄ‚îÄ
      const capexEstimate = hpCapacity * 8000 + storageLitres * 5; // rough Indian market
      const paybackYears = (capexEstimate / annualSavings).toFixed(1);

      // ‚îÄ‚îÄ‚îÄ BUILD RESULTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      goToStep(7);

      // Subtitle
      document.getElementById('resultsSubtitle').textContent =
        `${document.getElementById('customerName').value || 'Client'} ‚Äî ${facilityType.toUpperCase()} ‚Äî ${new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' })}`;

      // Summary
      document.getElementById('summaryGrid').innerHTML = `
    <div><b style="color:var(--text)">Client:</b> ${document.getElementById('customerName').value || '‚Äî'}</div>
    <div><b style="color:var(--text)">Facility:</b> ${facilityType}</div>
    <div><b style="color:var(--text)">Location:</b> ${document.getElementById('city').value || '‚Äî'}, ${document.getElementById('state').value || '‚Äî'}</div>
    <div><b style="color:var(--text)">Contact:</b> ${document.getElementById('contactPerson').value || '‚Äî'}</div>
    <div><b style="color:var(--text)">Demand:</b> ${dailyLitres.toLocaleString()} L/day</div>
    <div><b style="color:var(--text)">ŒîT:</b> ${coldTempVal}¬∞C ‚Üí ${hotTempVal}¬∞C</div>
    <div><b style="color:var(--text)">Op. Hours:</b> ${opHours} hrs/day</div>
    <div><b style="color:var(--text)">Ambient:</b> ${ambientStr}</div>
  `;

      // Metrics
      document.getElementById('metricsGrid').innerHTML = `
    <div class="metric-card">
      <span class="metric-icon">‚ö°</span>
      <div class="metric-label">Heat Pump Capacity</div>
      <div class="metric-value">${hpCapacity}</div>
      <div class="metric-unit">kW  (‚âà ${hpTR} TR)</div>
    </div>
    <div class="metric-card">
      <span class="metric-icon">üèóÔ∏è</span>
      <div class="metric-label">No. of Units</div>
      <div class="metric-value">${numUnits} √ó ${unitKW} kW</div>
      <div class="metric-unit">Heat Pump Units</div>
    </div>
    <div class="metric-card">
      <span class="metric-icon">üíß</span>
      <div class="metric-label">Storage Tank</div>
      <div class="metric-value blue">${storageLitres.toLocaleString()}</div>
      <div class="metric-unit">Litres</div>
    </div>
    <div class="metric-card">
      <span class="metric-icon">üå°Ô∏è</span>
      <div class="metric-label">Supply Temperature</div>
      <div class="metric-value gold">${hotTempVal}</div>
      <div class="metric-unit">¬∞C Hot Water</div>
    </div>
    <div class="metric-card">
      <span class="metric-icon">üìà</span>
      <div class="metric-label">Expected COP</div>
      <div class="metric-value green">${COP}</div>
      <div class="metric-unit">Coefficient of Performance</div>
    </div>
    <div class="metric-card">
      <span class="metric-icon">üí∏</span>
      <div class="metric-label">Est. Annual Saving</div>
      <div class="metric-value green">‚Çπ${(annualSavings / 100000).toFixed(1)}L</div>
      <div class="metric-unit">vs Electric Geyser</div>
    </div>
  `;

      // Spec table
      const specRows = [
        ['üíß', 'Daily Hot Water Demand', `${dailyLitres.toLocaleString()} Litres/day`],
        ['üå°Ô∏è', 'Cold Water Inlet Temp', `${coldTempVal}¬∞C`],
        ['üî•', 'Hot Water Supply Temp', `${hotTempVal}¬∞C`],
        ['üìê', 'Temperature Rise (ŒîT)', `${deltaT}¬∞C`],
        ['‚ö°', 'Daily Heat Load', `${heatKWh.toFixed(1)} kWh/day`],
        ['üïê', 'Operating Hours', `${opHours} hours/day`],
        ['üî•', 'Heat Pump Capacity', `${hpCapacity} kW ‚âà ${hpTR} TR (incl. 20% margin)`],
        ['üèóÔ∏è', 'Configuration', `${numUnits} √ó ${unitKW} kW unit${numUnits > 1 ? 's' : ''}`],
        ['üíß', 'Insulated Storage Tank', `${storageLitres.toLocaleString()} Litres (${(storagePct * 100).toFixed(0)}% of daily demand)`],
        ['üìà', 'Expected COP', `${COP} (${COP * 100 - 100}% better than electric)`],
        ['‚ö°', 'Daily Electrical Input', `${elecInputKWh.toFixed(1)} kWh/day`],
        ['üí∞', 'Est. Daily Energy Cost (HP)', `‚Çπ${elecCostHP.toFixed(0)}/day`],
        ['üí∏', 'Potential Annual Saving', `‚Çπ${(annualSavings / 1000).toFixed(0)}K/year vs. electric (${savingPct}%)`],
        ['üìä', 'Est. Simple Payback', `${paybackYears} years`],
        ['üåø', 'Estimated CO‚ÇÇ Reduction', `${((elecGeyserKWh - elecInputKWh) * 0.71 * 365 / 1000).toFixed(1)} tonnes CO‚ÇÇ/year`],
      ];

      document.getElementById('specTable').innerHTML = `
    <thead><tr>
      <th></th><th>Parameter</th><th>Recommended Value</th>
    </tr></thead>
    <tbody>${specRows.map(([icon, param, val]) =>
        `<tr><td style="font-size:16px;width:36px">${icon}</td><td>${param}</td><td>${val}</td></tr>`
      ).join('')}</tbody>
  `;

      // Calculation box
      document.getElementById('calcBox').innerHTML = `
<span class="eq">STEP 1 ‚Äî Daily Heat Load</span>
Q = m √ó Cp √ó ŒîT √∑ 3600
Q = ${dailyLitres.toLocaleString()} √ó 4.186 √ó (${hotTempVal} ‚àí ${coldTempVal}) √∑ 3600
<span class="result-eq">Q = ${heatKWh.toFixed(1)} kWh/day</span>

<span class="eq">STEP 2 ‚Äî Heat Pump Capacity (with 20% design margin)</span>
HP Capacity = (Q √∑ Operating Hours) √ó 1.20
HP Capacity = (${heatKWh.toFixed(1)} √∑ ${opHours}) √ó 1.20
<span class="result-eq">HP Capacity = ${hpCapacity} kW ‚âà ${hpTR} TR</span>

<span class="eq">STEP 3 ‚Äî Storage Tank</span>
Tank = Daily Demand √ó Storage Factor (${(storagePct * 100).toFixed(0)}%)
Tank = ${dailyLitres.toLocaleString()} √ó ${storagePct}
<span class="result-eq">Tank = ${storageLitres.toLocaleString()} Litres</span>

<span class="eq">STEP 4 ‚Äî COP &amp; Savings</span>
COP (${ambientStr} ambient) = ${COP}
Electrical Input = ${heatKWh.toFixed(1)} √∑ ${COP} = ${elecInputKWh.toFixed(1)} kWh/day
vs Electric (COP=1): ${elecGeyserKWh.toFixed(1)} kWh/day
<span class="result-eq">Annual Saving ‚âà ‚Çπ${(annualSavings / 1000).toFixed(0)}K/year (${savingPct}% reduction)</span>
  `;

      // Energy bars
      const maxBar = elecGeyserKWh;
      document.getElementById('energyBars').innerHTML = `
    <div class="bar-row">
      <div class="bar-label">HEAT PUMP</div>
      <div class="bar-track">
        <div class="bar-fill green" data-target="${(elecInputKWh / maxBar * 100).toFixed(0)}">${elecInputKWh.toFixed(0)} kWh</div>
      </div>
    </div>
    <div class="bar-row">
      <div class="bar-label">SOLAR + BACKUP</div>
      <div class="bar-track">
        <div class="bar-fill blue" data-target="${Math.min((elecInputKWh * 1.4 / maxBar * 100), 95).toFixed(0)}">${(elecInputKWh * 1.4).toFixed(0)} kWh*</div>
      </div>
    </div>
    <div class="bar-row">
      <div class="bar-label">LPG BOILER</div>
      <div class="bar-track">
        <div class="bar-fill orange" data-target="78">~${(elecGeyserKWh * 0.78).toFixed(0)} kWh equiv.</div>
      </div>
    </div>
    <div class="bar-row">
      <div class="bar-label">ELECTRIC GEYSER</div>
      <div class="bar-track">
        <div class="bar-fill orange" data-target="100">${elecGeyserKWh.toFixed(0)} kWh</div>
      </div>
    </div>
    <p style="font-family:var(--mono);font-size:10px;color:var(--text-dim);margin-top:8px;">* Estimated. LPG shown in electrical equivalent. Lower bar = better energy efficiency.</p>
  `;

      // Recommendations
      const recs = [];
      if (waterQuality !== 'Normal') recs.push('Install a heat exchanger / plate type HX to protect the heat pump from hard/high-TDS water.');
      if (ambientStr.includes('<15')) recs.push('Use low-ambient heat pump models rated for -10¬∞C operation (EVI compressor recommended).');
      if (numUnits > 1) recs.push(`Install ${numUnits} units of ${unitKW} kW in parallel for load balancing and redundancy.`);
      if (facilityType === 'Hospital') recs.push('Hospitals require 70‚Äì100% storage backup and redundant units. Consider 2N configuration.');
      if (hotTempVal >= 65) recs.push(`${hotTempVal}¬∞C delivery temp requires high-temp heat pump (cascade or EVI type). Verify with OEM.`);
      if (priority === 'Energy saving') recs.push('Pair with solar thermal pre-heating to further reduce electrical input by 20‚Äì30%.');
      recs.push(`Insulate all pipework and tank to minimize standby losses (target < 2% heat loss).`);
      recs.push('Install energy meter and IoT monitoring for real-time performance tracking and COP verification.');
      if (parseFloat(paybackYears) < 4) recs.push(`Excellent ROI ‚Äî estimated payback of ${paybackYears} years with strong financial case.`);

      document.getElementById('recBox').innerHTML = `
    <div class="rec-title">üí° Design & Sales Recommendations</div>
    <ul>${recs.map(r => `<li>${r}</li>`).join('')}</ul>
  `;

      // Warnings
      let warnings = '';
      if (dailyLitres > 50000) warnings += `<div class="rec-box" style="border-color:rgba(255,179,71,0.4);margin-top:16px"><div class="rec-title" style="color:var(--accent)">‚ö†Ô∏è Large Scale System Alert</div><ul><li>Demand exceeds 50,000 L/day ‚Äî consider multiple independent circuits.</li><li>Detailed piping design and pressure drop analysis required.</li></ul></div>`;
      if (ambientStr.includes('<15') && hotTempVal >= 65) warnings += `<div class="rec-box" style="border-color:rgba(255,69,96,0.4);margin-top:16px"><div class="rec-title" style="color:var(--danger)">üî¥ Critical: Low Ambient + High Temp Combo</div><ul><li>Low ambient with high delivery temp significantly reduces COP. Consider cascade heat pump or hybrid solar-HP system.</li></ul></div>`;
      document.getElementById('warningsBox').innerHTML = warnings;

      // Gen date
      document.getElementById('genDate').textContent = new Date().toLocaleString('en-IN');

      // Animate bars after render
      setTimeout(() => {
        document.querySelectorAll('.bar-fill').forEach(b => {
          b.style.width = b.dataset.target + '%';
        });
      }, 300);
    }

    function startOver() {
      if (confirm('Start a new assessment? All data will be cleared.')) {
        location.reload();
      }
    }

    function exportCSV() {
      const rows = [
        ['HeatPro System Sizing Report'],
        ['Generated', new Date().toLocaleString('en-IN')],
        [],
        ['Parameter', 'Value'],
        ['Customer', document.getElementById('customerName').value],
        ['Contact', document.getElementById('contactPerson').value],
        ['City', document.getElementById('city').value],
        ['State', document.getElementById('state').value],
        ...Array.from(document.querySelectorAll('#specTable tbody tr')).map(r =>
          [r.cells[1]?.textContent?.trim(), r.cells[2]?.textContent?.trim()]
        )
      ];

      const csv = rows.map(r => r.join(',')).join('\n');
      const a = document.createElement('a');
      a.href = URL.createObjectURL(new Blob([csv], { type: 'text/csv' }));
      a.download = 'HeatPro_Report_' + Date.now() + '.csv';
      a.click();
    }

    // ‚îÄ‚îÄ‚îÄ GOOGLE SHEET INTEGRATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzUr76L8n1vVAQatUCFODHyS9xWxHa7IM943C-N6b_1arLLYINqfukvY-m4DakeMTPu/exec';

    // ‚îÄ‚îÄ‚îÄ TOAST SYSTEM ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function showToast(type, message, duration) {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = `toast toast-${type}`;

      let iconHTML = '';
      if (type === 'loading') iconHTML = '<div class="toast-spinner"></div>';
      else if (type === 'success') iconHTML = '<span class="toast-icon">‚úÖ</span>';
      else if (type === 'error') iconHTML = '<span class="toast-icon">‚ùå</span>';

      toast.innerHTML = `${iconHTML}<span>${message}</span>`;
      container.appendChild(toast);

      if (duration) {
        setTimeout(() => removeToast(toast), duration);
      }
      return toast;
    }

    function removeToast(toast) {
      toast.classList.add('removing');
      setTimeout(() => toast.remove(), 300);
    }

    // ‚îÄ‚îÄ‚îÄ SAVE TO GOOGLE SHEET ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function saveToGoogleSheet() {
      const scriptUrl = GOOGLE_SCRIPT_URL;

      const btn = document.getElementById('btnSaveSheet');
      btn.disabled = true;
      btn.textContent = '‚è≥ Saving...';
      const loadingToast = showToast('loading', 'Sending data to Google Sheets...');

      // Gather all checkbox-based purposes
      const purposes = [];
      if (document.getElementById('pBathing')?.checked) purposes.push('Bathing');
      if (document.getElementById('pKitchen')?.checked) purposes.push('Kitchen/Washing');
      if (document.getElementById('pLaundry')?.checked) purposes.push('Laundry');
      if (document.getElementById('pProcess')?.checked) purposes.push('Process Heating');
      if (document.getElementById('pCleaning')?.checked) purposes.push('Cleaning/CIP');
      if (document.getElementById('pOther')?.checked) purposes.push('Others');
      const purposeOther = document.getElementById('purposeOther')?.value || '';
      if (purposeOther) purposes.push(purposeOther);

      // Gather problems
      const problems = [];
      if (document.getElementById('probElec')?.checked) problems.push('High Electricity Cost');
      if (document.getElementById('probFuel')?.checked) problems.push('High Fuel Cost');
      if (document.getElementById('probInsuff')?.checked) problems.push('Insufficient Hot Water');
      if (document.getElementById('probMaint')?.checked) problems.push('Maintenance Issues');
      if (document.getElementById('probSafety')?.checked) problems.push('Safety Concerns');
      if (document.getElementById('probEnv')?.checked) problems.push('Environmental/Pollution');

      // Hot temp
      let hotTemp = parseFloat(document.querySelector('input[name="hotTemp"]:checked')?.value) || 60;
      if (document.querySelector('input[name="hotTemp"]:checked')?.value === 'custom') {
        hotTemp = parseFloat(document.getElementById('hotTempCustom').value) || 60;
      }
      const coldTemp = parseFloat(document.querySelector('input[name="coldTemp"]:checked')?.value) || 22.5;

      // Daily demand
      const demandMode = document.querySelector('input[name="demandKnown"]:checked')?.value || 'known';
      let dailyLitres = 0;
      if (demandMode === 'known') {
        dailyLitres = parseFloat(document.getElementById('dailyLitres').value) || 0;
      } else {
        const bath = (parseFloat(document.getElementById('bathUsers').value) || 0) * (parseFloat(document.getElementById('bathLpd').value) || 30);
        const kitchen = (parseFloat(document.getElementById('kitchenUsers').value) || 0) * (parseFloat(document.getElementById('kitchenLpd').value) || 10);
        const laundry = (parseFloat(document.getElementById('laundryKg').value) || 0) * (parseFloat(document.getElementById('laundryLpd').value) || 10);
        const process = (parseFloat(document.getElementById('processUsers').value) || 0) * (parseFloat(document.getElementById('processLpd').value) || 50);
        dailyLitres = bath + kitchen + laundry + process;
      }

      const opHours = parseFloat(document.querySelector('input[name="opHours"]:checked')?.value) || 8;
      const ambientStr = document.querySelector('input[name="ambientTemp"]:checked')?.value || '25-35¬∞C';
      const facilityType = document.querySelector('input[name="facilityType"]:checked')?.value || '';
      const priority = document.querySelector('input[name="priority"]:checked')?.value || '';

      // Recalculate results for accuracy
      const deltaT = hotTemp - coldTemp;
      const heatKWh = (dailyLitres * 4.186 * deltaT) / 3600;
      let COP = 4.0;
      if (ambientStr.includes('<15')) COP = 3.0;
      else if (ambientStr.includes('15-25')) COP = 3.8;
      else if (ambientStr.includes('25-35')) COP = 4.2;
      else if (ambientStr.includes('>35')) COP = 4.5;
      if (hotTemp > 60) COP -= 0.3;
      if (hotTemp >= 70) COP -= 0.5;
      COP = Math.max(2.5, Math.round(COP * 10) / 10);

      const hpCapacity = Math.ceil((heatKWh / opHours) * 1.20);
      const hpTR = (hpCapacity / 3.517).toFixed(1);
      const unitSize = priority === 'Redundancy' ? Math.min(hpCapacity / 2, 15) : (hpCapacity <= 15 ? hpCapacity : 15);
      const numUnits = Math.ceil(hpCapacity / unitSize);
      const unitKW = Math.ceil(hpCapacity / numUnits);

      let storagePct = 0.60;
      if (['Hotel', 'Hostel', 'Residential Society'].includes(facilityType)) storagePct = 0.65;
      else if (facilityType === 'Hospital') storagePct = 0.80;
      else if (['Industrial Process', 'Dairy / Food Processing'].includes(facilityType)) storagePct = 0.50;
      if (priority === 'Low capital cost') storagePct = Math.min(storagePct, 0.50);
      if (priority === 'Redundancy') storagePct = Math.min(storagePct + 0.15, 1.0);
      const storageLitres = Math.ceil(dailyLitres * storagePct / 100) * 100;

      const elecInputKWh = heatKWh / COP;
      const elecCostHP = elecInputKWh * 8;
      const elecGeyserKWh = heatKWh * 1.05;
      const elecCostGeyser = elecGeyserKWh * 8;
      const annualSaving = (elecCostGeyser - elecCostHP) * 365;
      const savingPct = ((elecCostGeyser - elecCostHP) / elecCostGeyser * 100).toFixed(0);
      const capex = hpCapacity * 8000 + storageLitres * 5;
      const paybackYears = (capex / annualSaving).toFixed(1);
      const co2Reduction = ((elecGeyserKWh - elecInputKWh) * 0.71 * 365 / 1000).toFixed(1);

      const payload = {
        customerName: document.getElementById('customerName')?.value || '',
        contactPerson: document.getElementById('contactPerson')?.value || '',
        mobile: document.getElementById('mobile')?.value || '',
        email: document.getElementById('email')?.value || '',
        address: document.getElementById('address')?.value || '',
        city: document.getElementById('city')?.value || '',
        state: document.getElementById('state')?.value || '',
        facilityType: facilityType + (facilityType === 'Others' ? (' - ' + (document.getElementById('facilityOther')?.value || '')) : ''),
        purposes: purposes.join(', '),
        hotTemp: hotTemp,
        coldTemp: coldTemp,
        dailyLitres: dailyLitres,
        demandMode: demandMode,
        bathUsers: document.getElementById('bathUsers')?.value || '',
        bathLpd: document.getElementById('bathLpd')?.value || '',
        kitchenUsers: document.getElementById('kitchenUsers')?.value || '',
        kitchenLpd: document.getElementById('kitchenLpd')?.value || '',
        laundryKg: document.getElementById('laundryKg')?.value || '',
        laundryLpd: document.getElementById('laundryLpd')?.value || '',
        processUsers: document.getElementById('processUsers')?.value || '',
        processLpd: document.getElementById('processLpd')?.value || '',
        peakPattern: document.querySelector('input[name="peakPattern"]:checked')?.value || '',
        opHours: opHours,
        existingSystem: document.querySelector('input[name="existSys"]:checked')?.value || '',
        existingCapacity: document.getElementById('existCapacity')?.value || '',
        problems: problems.join(', '),
        installSpace: document.querySelector('input[name="installSpace"]:checked')?.value || '',
        elecPhase: document.querySelector('input[name="elecPhase"]:checked')?.value || '',
        voltage: document.getElementById('voltage')?.value || '',
        waterQuality: document.querySelector('input[name="waterQuality"]:checked')?.value || '',
        ambientTemp: ambientStr,
        priority: priority,
        budget: document.querySelector('input[name="budget"]:checked')?.value || '',
        notes: document.getElementById('notes')?.value || '',
        // Calculated results
        deltaT: deltaT,
        heatLoadKWh: parseFloat(heatKWh.toFixed(1)),
        cop: COP,
        hpCapacityKW: hpCapacity,
        hpCapacityTR: parseFloat(hpTR),
        numUnits: numUnits,
        unitSizeKW: unitKW,
        storageLitres: storageLitres,
        dailyElecInput: parseFloat(elecInputKWh.toFixed(1)),
        dailyCostHP: parseFloat(elecCostHP.toFixed(0)),
        dailyCostGeyser: parseFloat(elecCostGeyser.toFixed(0)),
        annualSaving: parseFloat(annualSaving.toFixed(0)),
        savingPct: parseInt(savingPct),
        paybackYears: parseFloat(paybackYears),
        co2Reduction: parseFloat(co2Reduction)
      };

      try {
        const response = await fetch(scriptUrl, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        // With no-cors, we can't read the response body, but if fetch didn't throw, it was sent
        removeToast(loadingToast);
        showToast('success', '‚úì Data sent to Google Sheets! Check your sheet to confirm.', 5000);
      } catch (err) {
        removeToast(loadingToast);
        showToast('error', 'Failed to save: ' + err.message + '. Check your URL and try again.', 6000);
      } finally {
        btn.disabled = false;
        btn.textContent = 'üíæ Save to Google Sheet';
      }
    }
  </script>
</body>

</html>
